"0","ratio_barpplot<-function(x){"
"0","  # here at first x will be in character format. "
"0","  barplt<-data %>% select(stroke, x, gender) %>% "
"0","            group_by(stroke,param=eval(parse(text=x))) %>% #parsing x from text to act as a column name"
"0","            summarise(count = length(gender)) %>% "
"0","            group_by(stroke) %>% "
"0","            mutate(ratio=round((count*100)/sum(count),1)) %>% "
"0","            ggplot(aes(x=stroke, y=ratio, fill=param)) + "
"0","            geom_bar(stat=""identity"") +"
"0","            scale_fill_manual(values=c(""orangered"", ""steelblue2""))+"
"0",""
"0","            labs(title = paste(""Ratio of having strokes for patients also suffering from"",x), fill=x)+"
"0","            theme_bw()"
"0","  return(barplt)"
"0","}"
"0",""
"0",""
